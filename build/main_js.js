"use strict";var formatFloat=function(t,r){return(Math.round(t*Math.pow(10,r))/Math.pow(10,r)).toFixed(r)},loanFormula={getRepayPerMouthPriceAi:function(t,r,a){var e=Math.pow(1+r,a);return t*r*e/(e-1)},getRepayInterestPerMouthAi:function(t,r,a,e){var o=[Math.pow(1+a,t),Math.pow(1+a,e)],p=o[0],l=o[1];return r*a*(p-l*(p-1)/(l-1))}};$(document).ready(function(){$(".calculate").click(function(){var t=$(".totalPrice").val()*$(".proportion").val()/10,r=$(".interest").val()/12/100,a=12*$(".period").val(),e={repayPerMouthObjAi:{repayInterestPerMouthArrAi:[],repayCapitalPerMouthArrAi:[],restCapitalArrAi:[],totalRepayedArrAi:[]},repayPerMouthObjAc:{repayInterestPerMouthArrAc:[],repayPerMouthPriceArrAc:[],restCapitalArrAc:[],totalRepayedArrAc:[]}},o=loanFormula.getRepayPerMouthPriceAi(t,r,a),p=t,l=0,i=t/a,A=t,h=0;!function(){for(var s=0;s<a;s++){var u=loanFormula.getRepayInterestPerMouthAi(s,t,r,a),n=o-u;p-=n,l+=o,e.repayPerMouthObjAi.repayInterestPerMouthArrAi.push(formatFloat(u,2)),e.repayPerMouthObjAi.repayCapitalPerMouthArrAi.push(formatFloat(n,2)),e.repayPerMouthObjAi.restCapitalArrAi.push(formatFloat(p,2)),e.repayPerMouthObjAi.totalRepayedArrAi.push(formatFloat(l,2));var c=t*r*(1-(s-1)/a),d=i+c;A-=i,h+=d,e.repayPerMouthObjAc.repayInterestPerMouthArrAc.push(formatFloat(c,2)),e.repayPerMouthObjAc.repayPerMouthPriceArrAc.push(formatFloat(d,2)),e.repayPerMouthObjAc.restCapitalArrAc.push(formatFloat(A,2)),e.repayPerMouthObjAc.totalRepayedArrAc.push(formatFloat(h,2))}}();var s=o*a,u=s-t;$(".total-loan").html(formatFloat(t,2)),$(".total-interest-ai").html(formatFloat(u,2)),$(".total-repay-ai").html(formatFloat(s,2)),$(".repay-per-mouth-ai").html(formatFloat(o,2));var n=$(".detail table");n.html('<table><tr><th>月份</th><th>等额本息月供金额（<span class="detail-capital">本金</span>/<span class="detail-interest">利息</span>）</th><th>等额本金月供金额（<span class="detail-capital">本金</span>/<span class="detail-interest">利息</span>）</th> <th>等额本息剩余本金</th> <th>等额本金剩余本金</th> <th>等额本息已还总额</th> <th>等额本金已还总额</th> </tr> </table>');for(var c=0;c<e.repayPerMouthObjAi.repayInterestPerMouthArrAi.length;c++)c%12+1==1&&n.append("<tr><td>第"+(parseInt(c/12)+1)+"年</td><td></td><td></td><td></td><td></td><td></td><td></td></tr>"),n.append("<tr><td>"+(c%12+1)+"</td><td>"+formatFloat(o,2)+'(<span class="detail-capital">'+e.repayPerMouthObjAi.repayCapitalPerMouthArrAi[c]+'</span>/<span class="detail-interest">'+e.repayPerMouthObjAi.repayInterestPerMouthArrAi[c]+"</span>)</td><td>"+e.repayPerMouthObjAc.repayPerMouthPriceArrAc[c]+'(<span class="detail-capital">'+formatFloat(i,2)+'</span>/<span class="detail-interest">'+e.repayPerMouthObjAc.repayInterestPerMouthArrAc[c]+"</span>)</td><td>"+e.repayPerMouthObjAi.restCapitalArrAi[c]+"</td><td>"+e.repayPerMouthObjAc.restCapitalArrAc[c]+"</td><td>"+e.repayPerMouthObjAi.totalRepayedArrAi[c]+"</td><td>"+e.repayPerMouthObjAc.totalRepayedArrAc[c]+"</td></tr>")})});